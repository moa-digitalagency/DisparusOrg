<!--
 * Nom de l'application : DISPARUS.ORG
 * Description : Carte interactive de l'administration
 * Produit de : MOA Digital Agency, www.myoneart.com
 * Fait par : Aisance KALONJI, www.aisancekalonji.com
 * Auditer par : La CyberConfiance, www.cyberconfiance.com
 -->
{% extends "admin_base.html" %}

{% block title %}Carte - Admin DISPARUS.ORG{% endblock %}

{% block page_title %}{% if get_locale() == 'fr' %}Carte interactive{% else %}Interactive map{% endif %}{% endblock %}
{% block page_subtitle %}{% if get_locale() == 'fr' %}Visualisation geographique des signalements{% else %}Geographic visualization of reports{% endif %}{% endblock %}

{% block admin_content %}
<div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
    <div class="p-4 border-b border-gray-100 flex flex-wrap items-center justify-between gap-3">
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full bg-red-500"></span>
                <span class="text-sm text-gray-600">{% if get_locale() == 'fr' %}Disparition{% else %}Missing{% endif %}</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full bg-green-500"></span>
                <span class="text-sm text-gray-600">{% if get_locale() == 'fr' %}Retrouve{% else %}Found{% endif %}</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full bg-orange-500"></span>
                <span class="text-sm text-gray-600">{% if get_locale() == 'fr' %}Signale{% else %}Flagged{% endif %}</span>
            </div>
        </div>
        <div class="flex items-center gap-3">
            <select id="admin-type-filter" class="text-sm border border-gray-200 rounded-xl px-3 py-2 bg-white focus:ring-2 focus:ring-red-500 focus:border-red-500">
                <option value="">{% if get_locale() == 'fr' %}Tous les types{% else %}All types{% endif %}</option>
                <option value="person">{% if get_locale() == 'fr' %}Personnes{% else %}Persons{% endif %}</option>
                <option value="animal">{% if get_locale() == 'fr' %}Animaux{% else %}Animals{% endif %}</option>
            </select>
            <select id="admin-country-filter" class="text-sm border border-gray-200 rounded-xl px-3 py-2 bg-white focus:ring-2 focus:ring-red-500 focus:border-red-500">
                <option value="">{% if get_locale() == 'fr' %}Tous les pays{% else %}All countries{% endif %}</option>
                {% set countries = disparus|map(attribute='country')|unique|sort %}
                {% for country in countries %}
                <option value="{{ country }}">{{ country }}</option>
                {% endfor %}
            </select>
            <span id="admin-count" class="text-sm text-gray-500">
                {{ disparus|length }} {% if get_locale() == 'fr' %}signalements{% else %}reports{% endif %}
            </span>
        </div>
    </div>
    <div id="admin-map" class="h-[600px]"></div>
</div>

<div id="hover-card" class="hover-card hidden">
    <div class="flex gap-3">
        <div id="hover-photo"></div>
        <div class="flex-1">
            <div id="hover-name" class="font-semibold text-gray-900 text-sm"></div>
            <div id="hover-location" class="text-xs text-gray-500 mt-0.5"></div>
            <div id="hover-status" class="mt-1"></div>
            <div id="hover-date" class="text-xs text-gray-400 mt-1"></div>
        </div>
    </div>
    <a id="hover-link" href="#" class="block mt-2 text-center text-xs text-red-600 hover:text-red-700 font-medium py-1.5 bg-red-50 rounded-lg">
        {% if get_locale() == 'fr' %}Voir la fiche{% else %}View profile{% endif %}
    </a>
</div>

<div id="admin-map-config"
     class="hidden"
     data-label-reports="{% if get_locale() == 'fr' %}signalements{% else %}reports{% endif %}">
</div>
{% endblock %}

{% block scripts %}
<link rel="stylesheet" href="/static/css/admin_map.css">
<script src="/static/js/admin_map.js"></script>
{% endblock %}
